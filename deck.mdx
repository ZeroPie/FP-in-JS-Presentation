import {
  CodeSurfer,
  CodeSurferColumns,
  Step,
} from "code-surfer";
import { github, vsDark } from "@code-surfer/themes";

export const theme = vsDark;

---

<CodeSurfer>

```js
                1. Functions
                2. Pure Functions
                3. Side Effects and the case for Purity
                5. Currying 🍛
                6. Composition
                7. Partial Aplication
                8. Example
```

```markdown title='Functional Programming'
  
     The process of building software by composing pure functions
          avoiding shared state, mutable data and side effects.
```

```md title='What is a Function?' subtitle='Deftones - Back to School.mp3'

  A Function is a process that maps the domain to the range.
  
            y = f(x * 2)
  
                f(1) = 2           
                f(2) = 4           
                f(3) = 6
```

```js title='What is a Function in JS?'
    
    An Object of type Function with properties and methods.

    Can have params, a body and a return value.
    
    Functions are "first class citizens" 🧐 
```

```js 1 file=./codesnipets/firstClassFunctions.js title='First Class Citizens 🧐?' subtitle='Assigned to Variables'
```

```js 3 file=./codesnipets/firstClassFunctions.js title='First Class Functions' subtitle='Used as arguments'
```

```js 5 file=./codesnipets/firstClassFunctions.js title='First Class Functions' subtitle='Stored in arrays'
```

```js 7 file=./codesnipets/firstClassFunctions.js title='First Class Functions' subtitle='Stored in objects'
```

```js title='Functions are Callable'   
  const hi = name => `Hi ${name}`

  const greet = name => hi(name)
```

```js title='Functions are Callable' subtitle="Same Thing"  
  const hi = name => `Hi ${name}`

  const greet = name => hi(name)           const greet = hi
```

```js title='Benefits of being Callable?'
const getServerStuff = callback => ajaxCall(json => callback(json))
```

```js title='Benefits of being Callable?' subtitle="Same Thing" 
const getServerStuff = callback =>         const getServerStuff = ajaxCall
  ajaxCall(json => callback(json))       
```

```js 9 file=./codesnipets/fetchUserGithub.js title='Benefits of being Callable?' subtitle="Friend without benefits"
  
```

```js file=./codesnipets/fetchUserGithub2.js title='Benefits of being Callable?' subtitle="Friend without benefits"
  
```

```js file=./codesnipets/fetchUserGithub3.js title='Benefits of being Callable?' subtitle="Friend without benefits"
  
```

```js file=./codesnipets/fetchUserGithub4.js title='Benefits of being Callable' subtitle="Friend with benefits"
  
```

```js 3,5 title='Certainty' subtitle='What should numbers be? Is double a function?'
                    const numbers = [1, 2, 3]

                    doubleStuff(numbers)

                    numbers // ?
```

```markdown title='Pure Function'
   Given the same input, will always return the same output.
   Produces no side effects.
```
 
```markdown title='Side Effects'
  Any application state change that is observable outside the called function 
  (other than its return value)
```

```js 9 title='The case for purity' subtitle="What do you expect?" file=./codesnipets/caseForPurity2.js
```

```js 4 title='Impurity giveaway' subtitle='No return value'
  
                            var counter = 1

                            incrementCounter()

                            console.log(counter) // 2  
```

```md title='Impurity Protection ✞'
  
     => Immutable Data Structures (e.g Immutable.js, ImmerJs)
     => Lenses (Functional getters/setters)
     => Freezing, Copying, Spreading
     => Avoiding Certain Methods (splice, pop, push, shift, unshift, foreach, u.a) 
     => Using Pure Methods (slice, concat, filter, map, reduce u.a)
     => Extract and Contain: Write pure Functions and move side Effects "down"
```

```md 4,5,6,7 title='Impurity Protection ✞' subtitle='No magic requiered'
  
     => Immutable Data Structures (e.g Immutable.js, ImmerJs)
     => Lenses (Functional getters/setters)
     => Freezing, Copying, Spreading
     => Avoiding Certain Methods (splice, pop, push, shift, unshift, foreach, u.a) 
     => Using Pure Methods (slice, concat, filter, map, reduce u.a)
     => Extract and Contain: Write pure Functions and move side Effects "down"
```

</CodeSurfer>

---

<CodeSurferColumns>

<Step title="Is this Pure✞™ ?">
  

```js file=./codesnipets/daysThisMonthImpure.js
```

```js
```

</Step>

<Step title="Is this Pure✞™ ?">
  

```1,2 file=./codesnipets/daysThisMonthImpure.js
```

```js
.
```

</Step>

<Step title="Extract Impurity">

```js file=./codesnipets/daysThisMonthImpure.js
```

```js file=./codesnipets/daysThisMonthPure.js
```

</Step>

<Step title="Extract Impurity">

```js file=./codesnipets/addCommentImpure.js
```

```js
`
```

</Step>

<Step title="Extract Impurity">

```js 3,8 file=./codesnipets/addCommentImpure.js
```

```js 7,10 file=./codesnipets/addCommentPure.js
```

</Step>


</CodeSurferColumns>

---

<CodeSurferColumns sizes={[1,1]}>

<Step title="Flow Statements make a difference" subtitle='Mutation in for Loops'>

```js file=./codesnipets/doubleItemsForLoop.js
```

```js
```

</Step>

<Step title="Methods make a difference">

```js 6[18:21] file=./codesnipets/doubleItemsForLoopV2.js
```

```js
''
```

</Step>

<Step title="Methods make a difference" subtitle='This can happen'>

```js 8,14 file=./codesnipets/doubleItemsMutate.js
```

```js
''
```

</Step>

<Step title="Methods make a Difference" subtitle='Be declarative and use pure methods'>

```js 8,14 file=./codesnipets/doubleItemsMutate.js
```

```js file=./codesnipets/doubleItemsMap.js
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Array Methods">

```js
splice()
pop()
push()
shift()
unshift()
```

```js
slice() 🍕
concat()
filter()
map()
reduce()
```

</Step>

<Step title="Array Methods">

```js
splice()

const pizzaArr = [0,1,2,3]  // const ¯\_( ツ )_/¯
slices.splice(0,2)
pizzaArr // [🍕. 🍕, 🍕] 

pop()
push()
shift()
unshift()
```

```js
slice() 🍕

const arr1 = [🍕, 🍕, 🍕, 🍕, 🍕];
const arr2 = arr1.slice(0, 2) // [🍕. 🍕, 🍕]

concat()
filter()
map()
reduce()
```

</Step>

<Step title="Array Methods">

```js
splice()
pop()

const fruits = [🍏, 🍑, 🍒]
fruits.pop()

push()
shift()
unshift()
```

```js
slice() 🍕

const fruits = [🍏, 🍑, 🍒]
const poppedFruits = fruits.slice(0, -1)

concat()
filter()
map()
reduce()
```

</Step>

<Step title="Array Methods">

```js
splice()
pop()
push()

const arr = [1,2]
arr.push(3)

shift()
unshift()
```

```js
slice() 🍕
concat()

const arr = [1,2]
const arr2 = arr1.concat[3]

filter()
map()
reduce()
```

</Step>

<Step>

```js title='Impure'
splice()
pop()
push()

const arr = [1,2]
arr.push(3)

shift()
unshift()
```

```js
slice() 🍕
concat()
...spread operator
const arr1 = [1,2]
const arr2 = [...arr1, 3]

filter()
map()
reduce()

```

</Step>

<Step>

```js
splice()
pop()
push()
shift()

const arr = [1,2,3]
const firstEle = arr.shift()  // 1, [2,3]

unshift()
```

```js
slice() 🍕

destructuring

const arr1 = [1,2,3]
const [first, ...rest] = arr1

concat()
filter()
map()
reduce()

```

</Step>

<Step title="Array Methods">

```js
splice()
pop()
push()
shift()
unshift()

const arr = [1,2]
arr.unshift(-1, 0)
arr // [-1,0,1,2]
```

```js
slice() 🍕
concat()
filter()
map()
reduce()

...spread operator
const arr = [1,2]
const newArr = [ -1, 0,...arr]

```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns sizes={[1,1]}>

<Step title="[].map">

```js
Die map() Methode wendet auf jedes Element des Arrays 
die bereitgestellte Funktion an 
und gibt das Ergebnis in einem neuen Array zurück.


arr.map(x => x * 2)
```

```js
```

</Step>

<Step>

```js file=./codesnipets/doubleItemsForLoop.js
```

```js
const doubleNumber = v => v * 2
const doubled = arr.map(doubleNumber)
```

</Step>


</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Currying 🍛" subtitle="Von Multiple Arguments zu eine Funktion die weniger arguments animmt">

``` js 3,4 file=./codesnipets/curryESNext.js
```

```js 5,6 file=./codesnipets/curryES15.js
```

</Step>

<Step title="Currying 🍛">

``` js 4 file=./codesnipets/curryESNext.js
```

```js 4 file=./codesnipets/curryES15.js
```

</Step>

<Step title="Currying 🍛" subtitle='Partial Application'>

``` js 7 file=./codesnipets/curryESNext.js
```

```js 9 file=./codesnipets/curryES15.js
```

</Step>

<Step title="Currying 🍛" subtitle='Partial Application'>

``` js 8 file=./codesnipets/curryESNext.js
```

```js 10 file=./codesnipets/curryES15.js
```

</Step>

<Step title="Currying 🍛" subtitle='Partial Application'>

``` js 8 file=./codesnipets/curryESNext.js
```

```js 10 file=./codesnipets/curryES15.js
```

</Step>

<Step title="Currying 🍛" subtitle='Partial Application'>

``` js 10:12 file=./codesnipets/curryESNext.js
```

```js 12:14 file=./codesnipets/curryES15.js
```

</Step>

<Step title="Composition 🍛" subtitle="Output einer Function als Input einer anderen nehmen">

```js 2
const doubleAndTriple = x 
  => double(triple(x))

arr.map(doubleAndTriple)
```

```js 2
var doubleAndTriple = function doubleAndTriple(x) {
  return double(triple(x));
};

arr.map(doubleAndTriple)
```

</Step>

<Step title="Composition" subtitle="sieht nicht mehr so lecker aus">

```js 
const tripleAdd3DivBy5 = x => divBy5(add2(triple(x)))
```

```js
var tripleAdd3DivBy5 = function tripleAdd3DivBy5(x) {
  return divBy5(add2(triple(x)))
}
```

</Step>

</CodeSurferColumns>  

---

<CodeSurferColumns>

<Step title="Composition Function">

```js 
const compose = (f1, f2) => f1 => f2(f1)
const add2Andtriple = compose(add2, triple)
const tripleAdd3DivBy5 = x => divBy5(add2Andtriple(x))
```

```js
var compose = function compose(f1, f2) {
  return function (f1) {
    return f2(f1);
  };
};

var add2Andtriple = compose(add2, triple);

var tripleAdd3DivBy5 = function tripleAdd3DivBy5(x) {
  return divBy5(add2Andtriple(x));
}
```

</Step>

<Step title="Composition Function">

```js 
const compose = (f1, f2, f3) 
  => (f1,f2)
  => f3(f2(f1))

const tripleAdd3DivBy5 = compose(divBy5, add2, triple)

arr.map(tripleAdd3DivBy5)
```

```js
var compose = function compose(f1, f2, f3) {
  return function (f1, f2) {
    return f3(f2(f1));
  };
};

var tripleAdd3DivBy5 = compose(divBy5, add2, triple);
arr.map(tripleAdd3DivBy5)
```

</Step>

<Step title="Composition">

```js 
const compose = (...functions) 
  => args 
  => functions.reduceRight((arg, fn) => fn(arg), args);
```

```js
var compose = function compose() {
  for (var _len = arguments.length, functions = new Array(_len), _key = 0; _key < _len; _key++) {
    functions[_key] = arguments[_key];
  }

  return function (args) {
    return functions.reduceRight(function (arg, fn) {
      return fn(arg);
    }, args);
  };
};
```

</Step>

<Step title="Switch it up a little we have Pipe">

```js 
const pipe = (...functions) 
  => args 
  => functions.reduce((arg, fn) => fn(arg), args);
```

```js

var pipe = function pipe() {
  for (var _len = arguments.length, functions = new Array(_len), _key = 0; _key < _len; _key++) {
    functions[_key] = arguments[_key];
  }

  return function (args) {
    return functions.reduce(function (arg, fn) {
      return fn(arg);
    }, args);
  };
};

```
</Step>

<Step title="Composing with Pipe">

```js 
const tripleAdd3DivBy5 = compose(divBy5,add2,triple)
```

```js
 const tripleAdd3DivBy5 = pipe(triple,add2,divBy5)
```
</Step>

<Step> 

```
Benefits:

 - Weniger Bugs 
 - Parallelism
 - Modularity
 - Testability
 - Lazy Evaluation
 - Easier to read (Takes time getting used to it)

 example: https://github.com/ZeroPie/changelog

```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns> 

<Step title="Reduce"> 

```js

arr.reduce(callback( accumulator, currentValue[, index[, array]] )[, initialValue])

```

</Step>

<Step title="Reduce"> 

```js
  Like a Swiss Knife.
  Can transform Data in a lot of ways
  You can implement other functions such as map and filter, flatMap and others!
  Sometimes called Fold

arr.reduce(callback( accumulator, currentValue[, index[, array]] )[, initialValue])

Ez right? Nah, not so evident! examples

```

</Step>

<Step title="Reduce" subtitle="The Swiss Knife"> 

``` js 
  const initialValue = 10
  const sodexosUsed = [1,1,1,1]

  const sodexosLeft = sodexosUsed.reduce((accumulator, currentValue) => accumulator - currentValue, initialValue)
```

</Step>

<Step title="Reduce" subtitle="Extracted to a reducer"> 

``` js 
  const initialValue = 10
  const sodexosUsed = [1,1,1,1]
  const sodexosReducer = (accumulator, currentValue) => accumulator - currentValue

  const sodexosLeft = sodexosUsed.reduce(sodexosReducer, initialValue)

```

</Step>


<Step title="Reduce" subtitle="Extracted to a reducer"> 

``` js 
  const initialValue = 10
  const sodexosUsed = [1,1,1,1]
  const sodexosReducer = (accumulator, currentValue) => accumulator - currentValue

  const sodexosLeft = sodexosUsed.reduce(sodexosReducer, initialValue)

```

</Step>

</CodeSurferColumns>